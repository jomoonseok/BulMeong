<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/header::head('QNA목록')}"></head>
<style>
	.blind {
		display: none;
	}
</style>
<script th:inline="javascript">
	
	$(document).ready(function(){
		
		$('#qnaqna').click(function(){
			//event.preventDefault();
			$('#toggle_area').toggleClass('blind');
		})
		
// 		function GetShow(){
// 			var con = document.getElementById("qnaqna");
// 			if(con.style.display =="none"){
// 				con.style.display == "block";
// 			} else {
// 				con.style.display == "none";
// 			}
// 		}
		
        var parentIpt = document.getElementById('parent_ipt');
        var btn_qnaWrite = document.getElementById('btn_qnaWrite');
        var childWindow = null;
        function openChildWindow(url, name) {
            const windowWidth = 500;
            const windowHeight = 700;
            const left = 700;
            const top = 170;
            const features = 'width=' + windowWidth + 'px,height=' + windowHeight + 'px,left=' + left + 'px,top=' + top + 'px';
            if(childWindow == null || childWindow.closed) {
                childWindow = open(url, name, features);
            }

       	}
        
        btn_qnaWrite.onclick = function(event){
        	openChildWindow('/popup', 'popup');
        }
        
        function setChildValue(qnaTitle, qnaContent){

            document.getElementById("${qna.qnaTitle}").value = qnaTitle;
            document.getElementById("${qna.qnaContent}").value = qnaContent;

      	}
	
	});
	
</script>
<body>

	
	<header th:replace="~{layout/header::header_layout}"></header>
	
	<!--
	<div>
		<input type="button" value="문의하기" id="btn_write">
		<input type="button" value="문의하기" onclick="fn_qnaWritePopup();">
	</div>
	
	<script>
		
		fn_qnaWritePopup();
	
		function fn_qnaWritePopup() {
			popup = window.open('/popup','qnaWritePopup','width=500,height=700,left=700,top=170,scrollbars=yes,resizable=yes,history=no');
		}
	</script>
	
	<script>
	
			function fn_qnaWritePopup(){
				$('#btn_write').click(function(event){
					window.open('/qna/write', 'qnaWritePop', 'left=700, top=170, width=500, height=700', history=no, reisizable=yes);
			});
			}
	</script>
	-->
	
<!-- 	<script>
 		function fn_qnaWritePopup() {
 			window.open('/popup','popup','width=500,height=700,left=700,top=170,scrollbars=yes,resizable=yes');
 		}
</script> -->
	<div>
		<h2>Q&A</h2>
		<input type="button" value="문의하기" id="btn_qnaWrite">
		<input type="button" value="내가 작성한 Q&A" id="my_qnaList">
	</div>
	
	
	
	
	
		
		
<!-- 		
if(noShowPopup != 'true') { -->
<!-- 			window.open('${contextPath}/view/popup', 'pop', 'width=400,height=410,top=100,left=500,menubar=no,history=no'); -->
<!-- 		} -->
	
	<hr>
	
		<table border="1">
			<thead>
				<tr>
					<th>답변상태</th>
					<th>제목</th>
					<th>작성자</th>
					<th>작성일</th>
<!-- 					loginUser가 관리자일때만 보이게 -->
					<th:block th:if="${session.loginUser} != null and ${session.loginUser.id} == 'admin'">
						<th>답변/삭제</th>
					</th:block>
				</tr>
			</thead>
			<tbody>
				<th:block th:each="qna:${qnaList}">
					<tr>
						<td>
							<span th:if="${qna.depth} eq 0">미답변</span>
							<span th:if="${qna.depth} eq 1">답변완료</span>
						</td>
						<td>
							<th:block th:if="${qna.qnaState} eq 1">
								<div class="btn_contentToggle">
									<a th:href="@{#}" th:text="${qna.qnaTitle}" id="qnaqna"></a>
								</div>
								<div id="toggle_area" class="blind">
									<div th:text="${qna.qnaContent}">
										<div th:if="${session.loginUser} != null and ${session.loginUser.id} == 'admin'">
											<input type="button" value="답변하기">
										</div>
									</div>
								</div>
							</th:block>
							
							<th:block th:if="${qna.qnaState} eq 2">
								<div th:if="${session.loginUser} != null and ${session.loginUser.id} == ${qna.id} or ${session.loginUser.id} == 'admin'">
									<div class="btn_contentToggle">
										<a th:href="@{#}" th:text="${qna.qnaTitle}" id="qnaqna"></a>
										<div id="toggle_area" class="blind">
											<span th:text="${qna.qnaTitle}"></span><br>
											<span th:text="${qna.qnaContent}"></span>
										</div>
										<div th:text="${qna.qnaContent}" class="blind">
											<div th:if="${session.loginUser} != null and ${session.loginUser.id} == 'admin'">
												<input type="button" value="답변하기">
											</div>
										</div>
									</div>
								</div>
								<div th:if="${session.loginUser} != null and ${session.loginUser.id} != ${qna.id} and ${session.loginUser.id} != 'admin'">
									<div>비밀글입니다</div>
								</div>
<!--  								<div th:if="${session.loginUser} != null and ${session.loginUser.id} == 'admin'"> -->
<!--  									<div th:text="${qna.qnaTitle}" id="btn_contentToggle"></div> -->
<!-- 									<div th:text="${qna.qnaContent}" class="blind"></div> -->
<!--  								</div> -->
							</th:block>
							
<!-- 							<th:block th:if="${qna.qnaState} eq 0"> -->
<!-- 								<div>삭제된글입니다.</div> -->
<!-- 							</th:block> -->
							
						</td>
						<td th:utext=${qna.id}></td>
<!-- 						<td th:text="$(#dates.fomat(qna.qnaCreateDate,'yyyy/M/d))" ></td> -->
						<td th:utext=${qna.qnaCreateDate}></td>
						
<!-- 						<th:block th:if="${loginUser == 'admin'}"> -->
<!-- 							<td><input type="button" value="답변달기" id="btn_reply_qna"></td> -->
<!-- 						</th:block> -->
<!-- 					<th:block th:if="${qna.qnaState == 0}"> -->
<!-- 						<div>삭제됐음</div> -->
<!-- 					</th:block> -->
						<th:block th:if="${session.loginUser} != null and ${session.loginUser.id} == 'admin'">
							<td>
								<input type="button" value="답변" id="btn_answer">/
								<input type="button" value="삭제" id="btn_remove">
							</td>
						</th:block>
					</tr>
				</th:block>
			</tbody>
			<tfoot>
				<tr>
					<td colspan="5" th:utext="${paging}"></td>
				</tr>
			</tfoot>
		</table>

</body>
</html>